<template>
    <div class="center-content">
        <div class="user-info-tile">
            <div class="back-link-div">
                <c-hot_back-button></c-hot_back-button>
            </div>

            <h1 id="user-info-header">Min profil</h1>

            <section>
                <!-- Kontaktinformasjon -->
                <section class="sub-form">
                    <h2 id="contact-info-header" style="text-align: center">Kontaktinformasjon</h2>
                    <div
                        if:true={isAlternativeNumber}
                        class="navno-dekorator alertstripe navno-dekorator alertstripe--info"
                    >
                        <img
                            class="navno-dekorator alertstripe__ikon"
                            src={informationIcon}
                            alt=""
                            aria-hidden="true"
                        />
                        <div class="alertstripe__content">
                            <div class="typo-normal alertstripe__tekst">{alternativePhoneNumberText}</div>
                            <div class="typo-normal alertstripe__tekst">
                                Mobilnummeret du vil bli varslet på nå: {mobilePhoneOverride}
                            </div>
                            <div class="typo-normal alertstripe__tekst">Årsak: {mobilePhoneOverrideReason}</div>
                        </div>
                    </div>

                    <div class="my-grid">
                        <div class="my-col-half">
                            <label class="output-label" for="mobilePhone"
                                >Mobilnummer fra Kontakt- og reservasjonsregisteret</label
                            >
                            <p id="mobilePhone" class="output-value">{mobilePhoneKRR}</p>
                        </div>
                        <div class="my-col-half">
                            <label class="output-label" for="email">E-postadresse</label>
                            <p id="email" class="output-value">{email}</p>
                        </div>
                    </div>

                    <p>
                        <a
                            href="https://minprofil.kontaktregisteret.no/"
                            class="lenke"
                            target="_blank"
                            rel="noopener noreferrer"
                            onclick={setKrrIntegrationStatusToQueued}
                            aria-label="Endre i Kontakt- og reservasjonsregisteret"
                        >
                            Endre i Kontakt- og reservasjonsregisteret
                        </a>
                    </p>
                    <div
                        if:true={isKrrQueued}
                        class="navno-dekorator alertstripe navno-dekorator alertstripe--advarsel"
                        role="alert"
                        aria-live="polite"
                    >
                        <img class="navno-dekorator alertstripe__ikon" src={warningicon} alt="" aria-hidden="true" />
                        <div class="typo-normal alertstripe__tekst">
                            Kontaktinformasjonen vil bli oppdatert innen 24 timer
                        </div>
                    </div>
                </section>

                <!-- Vedtak -->
                <section class="sub-form">
                    <h3 id="vedtak-header" class="sub-header">Vedtak</h3>
                    <template lwc:if={hasVedtak}>
                        <div class="my-grid">
                            <div class="my-col-half">
                                <template for:each={vedtakLabels} for:item="label">
                                    <p key={label} class="output-value">{label}</p>
                                </template>
                            </div>
                        </div>
                    </template>
                    <template lwc:else>
                        <p class="output-value">Ingen vedtak registrert.</p>
                    </template>
                </section>

                <!-- Tolkemetoder -->
                <section class="sub-form">
                    <h3 id="tolkemetoder-header" class="sub-header">Tolkemetoder</h3>
                    <template lwc:if={hasTolkemetoder}>
                        <div class="my-grid">
                            <div class="my-col-half">
                                <template for:each={tolkemetoderLabels} for:item="label">
                                    <p key={label} class="output-value">{label}</p>
                                </template>
                            </div>
                        </div>
                    </template>
                    <template lwc:else>
                        <p class="output-value">Ingen tolkemetoder registrert.</p>
                    </template>
                </section>

                <!-- Annet -->
                <section class="sub-form">
                    <h3 id="annet-header" class="sub-header">Annet</h3>
                    <div class="my-grid">
                        <div class="my-col-half">
                            <label class="output-label" for="degreeOfImpairment">Vedtak</label>
                            <p id="degreeOfImpairment" class="output-value">{degreeOfImpairment}</p>
                        </div>
                        <div class="my-col-half">
                            <label class="output-label" for="sipAddress">SIP-Adresse Bildetolk</label>
                            <p id="sipAddress" class="output-value">{sipAddress}</p>
                        </div>
                    </div>
                </section>

                <!-- Sikkerhetstiltak -->
                <section class="sub-form">
                    <h3 id="security-measures-header" class="sub-header">Sikkerhetstiltak</h3>
                    <div lwc:if={hasSecurityMeasures}>
                        <template for:each={securityMeasures} for:item="sm">
                            <p key={sm}>{sm}</p>
                        </template>
                    </div>
                </section>

                <!-- Varslingsinnstillinger -->
                <section class="sub-form" aria-live="polite">
                    <h2 id="notification-settings-edit-header" style="text-align: center">
                        Rediger varslingsinnstillinger
                    </h2>
                    <div class="my-grid">
                        <div class="my-col-half">
                            <c-picklist
                                master-label="Velg hvor du vil få varsler"
                                choices={picklistOptions}
                                onpicklistvaluechange={selectionChangeHandler}
                                onclick={handleCloseSuccess}
                                onkeydown={handleCloseSuccess}
                            ></c-picklist>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Success message -->
            <div class="sr-only" aria-live="assertive" role="status">{ariaMessage}.</div>

            <template lwc:if={showSuccess}>
                <div class="navno-dekorator alertstripe navno-dekorator alertstripe--success">
                    <img class="navno-dekorator alertstripe__ikon" src={successicon} alt="" />
                    <div class="typo-normal alertstripe__tekst">
                        <p>{successMessage}</p>
                    </div>
                    <button
                        class="navno-dekorator close-success-button"
                        onclick={handleCloseSuccess}
                        aria-label="Lukk melding"
                    >
                        &times;
                    </button>
                </div>
            </template>
        </div>
    </div>
</template>
